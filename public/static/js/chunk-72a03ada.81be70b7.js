(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72a03ada"],{1564:function(e,t,r){"use strict";var n=r("485e"),a=r("bc2f").map,s=r("243e"),i=r("64f1"),o=s("map"),c=i("map");n({target:"Array",proto:!0,forced:!o||!c},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"1e4b":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"autopublish"},[r("Headers",{scopedSlots:e._u([{key:"left",fn:function(){return[r("bread")]},proxy:!0},{key:"right",fn:function(){return[r("Button",{attrs:{type:"primary",disabled:e.stepnow>3},on:{click:e.addProject}},[e._v("添加项目")])]},proxy:!0}])}),r("div",{staticClass:"content"},[r("el-steps",{attrs:{direction:"vertical",active:e.stepnow}},e._l(e.steps,(function(t,n){return r("el-step",{key:n,attrs:{title:t.title,description:t.description,icon:e.stepnow>3&&e.stepnow==n+1&&!t.error?"el-icon-loading":"",status:t.error?"error":""}},[t.slotTitle?r("template",{slot:"title"},["project"==t.id?r("Select",{attrs:{hideClear:!0,disabled:e.stepnow>3,selectdata:e.projectList,placeholder:"请选择项目"},on:{change:e.getBranch},model:{value:e.project,callback:function(t){e.project=t},expression:"project"}}):e._e(),"branch"==t.id?r("Select",{attrs:{hideClear:!0,disabled:!e.project||e.stepnow>3,selectdata:e.branchList,placeholder:"请选择分支"},on:{change:e.setBranch},model:{value:e.branch,callback:function(t){e.branch=t},expression:"branch"}}):e._e(),"start"==t.id?r("Button",{attrs:{disabled:!e.project||!e.branch||e.stepnow>3},on:{click:e.buiding}},[e._v("开始")]):e._e()],1):e._e()],2)})),1)],1),r("addProject",{attrs:{modalStatus:e.modalStatus},on:{modalClose:e.modalClose}}),r("publishSuccess",{attrs:{modalPubStatus:e.modalPubStatus,remotePath:e.remotePath,distName:e.distName},on:{modalClose:e.modalPubClose}})],1)},a=[],s=(r("034f"),r("3610"),r("1564"),r("f644"),r("6a61"),r("2e91")),i=[{id:"project",title:"项目",slotTitle:!0,error:!1},{id:"branch",title:"分支",slotTitle:!0,error:!1},{id:"start",title:"开始",slotTitle:!0,error:!1},{id:"gitpull",title:"更新代码",slotTitle:!1,error:!1,description:"拉取最新代码和相关依赖",fun:"gitpull"},{id:"runbuild",title:"打包构建",slotTitle:!1,error:!1,description:"执行打包构建命令",fun:"runbuild"},{id:"createversion",title:"版本信息",slotTitle:!1,error:!1,description:"创建版本信息version.txt",fun:"createversion"},{id:"compressing",title:"压缩",slotTitle:!1,error:!1,description:"将打包之后的文件压缩为zip",fun:"compressing"},{id:"upload",title:"上传",slotTitle:!1,error:!1,description:"上传至103FTP文件服务器",fun:"basicftp"}],o={data:function(){return{modalStatus:!1,modalPubStatus:!1,projectList:[],project:"",branchList:[],branch:"",distName:"",remotePath:"",steps:i,stepnow:1}},computed:{disabledStart:function(){return!(this.project&&this.branch)}},mounted:function(){this.getProject()},methods:{addProject:function(){this.modalStatus=!0},modalClose:function(){this.modalStatus=!1,this.getProject()},modalPubClose:function(){this.modalPubStatus=!1,this.stepnow=1},buiding:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.stepnow++,r=e.steps.filter((function(e){return e.fun})).map((function(e){return e.fun})),n=0;case 3:if(!(n<r.length)){t.next=13;break}return t.next=6,e[r[n]]();case 6:if(!t.sent){t.next=9;break}return e.steps[e.stepnow-1].error=!0,t.abrupt("break",13);case 9:e.stepnow++;case 10:n++,t.next=3;break;case 13:case"end":return t.stop()}}),t)})))()},getProject:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.projectList=[],t.next=3,e.$axios.post(e.$api.getProject);case 3:if(r=t.sent,n=r.data,a=n.Content,s=n.Result,i=n.ResultMsg,"failture"!=s){t.next=10;break}return t.abrupt("return",e.$message.error(i));case 10:o=[],a.forEach((function(e,t){o.push({id:e,name:e})})),e.projectList=o;case 13:case"end":return t.stop()}}),t)})))()},getBranch:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.branch="",e.branchList=[],t.next=4,e.$axios.post(e.$api.getBranch,{project:e.project});case 4:if(r=t.sent,n=r.data,a=n.Content,s=n.Result,i=n.ResultMsg,"failture"!=s){t.next=11;break}return t.abrupt("return",e.$message.error(i));case 11:o=[],a.forEach((function(e,t){o.push({id:e,name:e})})),e.branchList=o,e.stepnow=2;case 15:case"end":return t.stop()}}),t)})))()},setBranch:function(){this.stepnow=3},gitpull:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post(e.$api.gitpull,{project:e.project,branch:e.branch});case 2:if(r=t.sent,n=r.data,a=n.Result,s=n.ResultMsg,"failture"!=a){t.next=9;break}return e.$message.error(s),t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})))()},runbuild:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post(e.$api.runbuild,{project:e.project,branch:e.branch});case 2:if(r=t.sent,n=r.data,a=n.Result,s=n.ResultMsg,"failture"!=a){t.next=9;break}return e.$message.error(s),t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})))()},createversion:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post(e.$api.createversion,{project:e.project,branch:e.branch});case 2:if(r=t.sent,n=r.data,a=n.Content,s=n.Result,i=n.ResultMsg,"failture"!=s){t.next=10;break}return e.$message.error(i),t.abrupt("return",!0);case 10:e.distName=a.distName;case 11:case"end":return t.stop()}}),t)})))()},compressing:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post(e.$api.compressing,{project:e.project,distName:e.distName});case 2:if(r=t.sent,n=r.data,a=n.Result,s=n.ResultMsg,"failture"!=a){t.next=9;break}return e.$message.error(s),t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})))()},basicftp:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post(e.$api.basicftp,{project:e.project,distName:e.distName});case 2:if(r=t.sent,n=r.data,a=n.Content,s=n.Result,i=n.ResultMsg,"failture"!=s){t.next=10;break}return e.$message.error(i),t.abrupt("return",!0);case 10:e.remotePath=a,e.modalPubStatus=!0;case 12:case"end":return t.stop()}}),t)})))()}}},c=o,u=(r("3e0c"),r("c701")),l=Object(u["a"])(c,n,a,!1,null,null,null);t["default"]=l.exports},"3e0c":function(e,t,r){"use strict";r("616d")},"616d":function(e,t,r){}}]);